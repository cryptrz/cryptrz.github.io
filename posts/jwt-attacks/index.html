<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Portswigger writeup - JWT Attacks" /><meta property="og:locale" content="en" /><meta name="description" content="Since I’ve created this website, I didn’t write a “real” post yet. So, as a first start, I’ll talk about the new labs provided by Portswigger’s Web Security Academy few days ago: JWT Attacks). This is also my very first writeup ever, I hope everything will be clear (Let me know in a private message on Linkedin if you see something wrong, I’ll fix it)." /><meta property="og:description" content="Since I’ve created this website, I didn’t write a “real” post yet. So, as a first start, I’ll talk about the new labs provided by Portswigger’s Web Security Academy few days ago: JWT Attacks). This is also my very first writeup ever, I hope everything will be clear (Let me know in a private message on Linkedin if you see something wrong, I’ll fix it)." /><link rel="canonical" href="https://cryptrz.github.io/posts/jwt-attacks/" /><meta property="og:url" content="https://cryptrz.github.io/posts/jwt-attacks/" /><meta property="og:site_name" content="cryptrz" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-18T00:00:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Portswigger writeup - JWT Attacks" /><meta name="twitter:site" content="@cryptrz" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-06-18T19:55:56+03:00","datePublished":"2022-06-18T00:00:00+03:00","description":"Since I’ve created this website, I didn’t write a “real” post yet. So, as a first start, I’ll talk about the new labs provided by Portswigger’s Web Security Academy few days ago: JWT Attacks). This is also my very first writeup ever, I hope everything will be clear (Let me know in a private message on Linkedin if you see something wrong, I’ll fix it).","headline":"Portswigger writeup - JWT Attacks","mainEntityOfPage":{"@type":"WebPage","@id":"https://cryptrz.github.io/posts/jwt-attacks/"},"url":"https://cryptrz.github.io/posts/jwt-attacks/"}</script><title>Portswigger writeup - JWT Attacks | cryptrz</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="cryptrz"><meta name="application-name" content="cryptrz"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/images/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">cryptrz</a></div><div class="site-subtitle font-italic">Hacking is poetry</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/portfolio/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>PORTFLIO</span> </a><li class="nav-item"> <a href="/Links/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>USEFUL LINKS</span> </a><li class="nav-item"> <a href="/cheatsheet/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>PENTEST CHEAT SHEET</span> </a><li class="nav-item"> <a href="/bugbountychecklist/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>BUG BOUNTY CHECKLIST</span> </a><li class="nav-item"> <a href="/apichecklist/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>API SECURITY CHECKLIST</span> </a><li class="nav-item"> <a href="/thugbounty/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>THUG BOUNTY</span> </a><li class="nav-item"> <a href="/troublefake/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>TROUBLE FAKE</span> </a><li class="nav-item"> <a href="/contacts/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>CONTACTS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/cryptrz" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cryptrz" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['cryptrz','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/franck-ridel/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Portswigger writeup - JWT Attacks</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Portswigger writeup - JWT Attacks</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1655499600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 18, 2022 </em> </span> <span> Updated <em class="" data-ts="1687107356" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 18, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/cryptrz">cryptrz</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1031 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><p>Since I’ve created this website, I didn’t write a “real” post yet. So, as a first start, I’ll talk about the new labs provided by Portswigger’s <a href="https://portswigger.net/web-security/dashboard" target="_blank">Web Security Academy</a> few days ago: <a href="https://portswigger.net/web-security/jwt" target="_blank">JWT Attacks</a>). This is also my very first writeup ever, I hope everything will be clear (Let me know in a private message on <a href="https://www.linkedin.com/in/franck-ridel/" target="_blank">Linkedin</a> if you see something wrong, I’ll fix it).</p><p>As I write this post, I solved only the 3 first labs. The next ones will be added in an update to this post or in a “part 2”, soon.</p><h1 id="preparation">Preparation</h1><p>Before starting, install the <a href="https://portswigger.net/bappstore/26aaa5ded2f74beea19e2ed8345a93dd" target="_blank">JWT Editor</a> extension on <a href="https://portswigger.net/burp" target="_blank">Burp Suite</a> (available for <a href="https://portswigger.net/burp/communitydownload" target="_blank">Community</a> and <a href="https://portswigger.net/burp/pro" target="_blank">Professional</a> versions), it will be used for all labs.</p><h1 id="lab-1-jwt-authentication-bypass-via-unverified-signature">Lab 1: JWT authentication bypass via unverified signature</h1><ol><li><p>Go to My Account</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-1.png" alt="jwt-attacks-1-1" data-proofer-ignore></p><li><p>Enter the credentials “wiener” and “peter”</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-2.png" alt="jwt-attacks-1-2" data-proofer-ignore></p><li><p>From the HTTP History, send the “/my-account” page to repeater</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-3.png" alt="jwt-attacks-1-3" data-proofer-ignore></p><li><p>Highlight the payload part of the token and go to the “Decoded from” section on the right side</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-4.png" alt="jwt-attacks-1-4" data-proofer-ignore></p><li><p>Change “wiener” to “administrator” and click on “Apply changes”</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-5.png" alt="jwt-attacks-1-5" data-proofer-ignore></p><li><p>Send the modified page, if successful the response will be a code 200</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-6.png" alt="jwt-attacks-1-6" data-proofer-ignore></p><li><p>Get the link to the response and paste it in the web browser</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-7-1.png" alt="jwt-attacks-1-7-1" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-7-2.png" alt="jwt-attacks-1-7-2" data-proofer-ignore></p><li><p>When the admin account is displayed, click on “Admin panel” link</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-8.png" alt="jwt-attacks-1-8" data-proofer-ignore></p><li><p>Find the “/admin” page in the HTTP History and repeat the previous steps from 3 to 7</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-9-1.png" alt="jwt-attacks-1-9-1" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-9-3.png" alt="jwt-attacks-1-9-3" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-9-4.png" alt="jwt-attacks-1-9-4" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-9-5.png" alt="jwt-attacks-1-9-5" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-9-6.png" alt="jwt-attacks-1-9-6" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-9-7.png" alt="jwt-attacks-1-9-7" data-proofer-ignore></p><li><p>When the “Admin panel” is displayed, click on the “delete” link for “carlos”</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-10.png" alt="jwt-attacks-1-10" data-proofer-ignore></p><li><p>Repeat the same steps again, from 3 to 7 (except the time, the final response will be a 302 and not a 200), for the “/admin/delete?username=carlos” page</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-11-1.png" alt="jwt-attacks-1-11-1" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-11-2.png" alt="jwt-attacks-1-11-2" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-11-3.png" alt="jwt-attacks-1-11-3" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-11-4.png" alt="jwt-attacks-1-11-4" data-proofer-ignore></p><li><p>Go back to the browser, the lab is solved</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/1-12.png" alt="jwt-attacks-1-12" data-proofer-ignore></p></ol><h1 id="lab-2-jwt-authentication-bypass-via-flawed-signature-verification">Lab 2: JWT authentication bypass via flawed signature verification</h1><ol><li><p>Go to My Account</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-1.png" alt="jwt-attacks-2-1" data-proofer-ignore></p><li><p>From the HTTP History, send the “/my-account” page to Repeater</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-2.png" alt="jwt-attacks-2-2" data-proofer-ignore></p><li><p>Highlight the Header part of the token and go to the “Decoded from” section on the right side</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-3.png" alt="jwt-attacks-2-3" data-proofer-ignore></p><li><p>Change “RS256” to “none” and click on “Apply changes”</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-4.png" alt="jwt-attacks-2-4" data-proofer-ignore></p><li><p>Highlight the Payload part of the token and go to the “Decoded from” section on the right side</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-5.png" alt="jwt-attacks-2-5" data-proofer-ignore></p><li><p>Change “wiener” to “administrator” and click on “Apply changes”</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-6.png" alt="jwt-attacks-2-6" data-proofer-ignore></p><li><p>Highlight the Signature of the token and delete it</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-7.png" alt="jwt-attacks-2-7" data-proofer-ignore></p><li><p>Send the modified reset, if successful, the response will be a code 200</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-8.png" alt="jwt-attacks-2-8" data-proofer-ignore></p><li><p>Get the link to the response and paste it in the browser</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-9-1.png" alt="jwt-attacks-2-9-1" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-9-2.png" alt="jwt-attacks-2-9-2" data-proofer-ignore></p><li><p>When the admin account is displayed, click on “Admin panel”</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-10.png" alt="jwt-attacks-2-10" data-proofer-ignore></p><li><p>Find the “/admin” page in the HTTP History and repeat the same steps from 2 to 9</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-11-1.png" alt="jwt-attacks-2-11-1" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-11-2.png" alt="jwt-attacks-2-11-2" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-11-3.png" alt="jwt-attacks-2-11-3" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-11-4.png" alt="jwt-attacks-2-11-4" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-11-5.png" alt="jwt-attacks-2-11-5" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-11-6.png" alt="jwt-attacks-2-11-6" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-11-7.png" alt="jwt-attacks-2-11-7" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-11-8.png" alt="jwt-attacks-2-11-8" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-11-9.png" alt="jwt-attacks-2-11-9" data-proofer-ignore></p><li><p>When the Admin panel is displayed, click on the “delete” link for “carlos”</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-12.png" alt="jwt-attacks-2-12" data-proofer-ignore></p><li><p>Find the “/admin/delete?username=carlos” page in the HTTP History and repeat the same steps from 2 to 9 (The final response will be a code 302, not 200)</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-13-1.png" alt="jwt-attacks-2-13-1" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-13-2.png" alt="jwt-attacks-2-13-2" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-13-3.png" alt="jwt-attacks-2-13-3" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-13-4.png" alt="jwt-attacks-2-13-4" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-13-5.png" alt="jwt-attacks-2-13-5" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-13-6.png" alt="jwt-attacks-2-13-6" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-13-7.png" alt="jwt-attacks-2-13-7" data-proofer-ignore></p><li><p>Go back to the browser, the lab is solved</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/2-14.png" alt="jwt-attacks-2-14" data-proofer-ignore></p></ol><h1 id="lab-3-jwt-authentication-bypass-via-weak-signing-key">Lab 3: JWT authentication bypass via weak signing key</h1><ol><li>Save this JWT secrets list: <a href="https://raw.githubusercontent.com/wallarm/jwt-secrets/master/jwt.secrets.list">https://raw.githubusercontent.com/wallarm/jwt-secrets/master/jwt.secrets.list</a><li><p>Enter the credentials “wiener:peter”</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-2.png" alt="jwt-attacks-3-2" data-proofer-ignore></p><li><p>Go to “My account” page</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-3.png" alt="jwt-attacks-3-3" data-proofer-ignore></p><li><p>In the HTTP History, send the page to the Repeater</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-4.png" alt="jwt-attacks-3-4" data-proofer-ignore></p><li><p>Copy the token</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-5.png" alt="jwt-attacks-3-5" data-proofer-ignore></p><li><p>Use hashcat to get the secret, using the token copied above and the JWT Secret List downloaded at step 1: <code class="language-plaintext highlighter-rouge">hashcat -a 0 -m 16500 &lt;token&gt; &lt;JWT secrets list&gt;</code></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-6.png" alt="jwt-attacks-3-6" data-proofer-ignore></p><li><p>Use the upper arrow (↑) the go back to the previous command and add <code class="language-plaintext highlighter-rouge">—show</code> at the end to get the secret key (the result will be “secret1”)</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-7.png" alt="jwt-attacks-3-7" data-proofer-ignore></p><li><p>On <a href="https://jwt.io">jwt.io</a>, paste the token in the “Encoded” section, replace “wiener” with “administrator” and add “secret1” as a secret</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-8.png" alt="jwt-attacks-3-8" data-proofer-ignore></p><li><p>Copy the new token generated on <a href="http://jwt.io">jwt.io</a>, paste it in the Repeater and send the reset, you’ll get code 200</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-9-1.png" alt="jwt-attacks-3-9-1" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-9-2.png" alt="jwt-attacks-3-9-2" data-proofer-ignore></p><li><p>Get the link to the response and paste it in the browser</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-10-1.png" alt="jwt-attacks-3-10-1" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-10-2.png" alt="jwt-attacks-3-10-2" data-proofer-ignore></p><li><p>When the admin account is displayed, go to the “Admin panel”</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-11-1.png" alt="jwt-attacks-3-11-1" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-11-2.png" alt="jwt-attacks-3-11-2" data-proofer-ignore></p><li><p>In the HTTP History, find the “/admin” page and send it to the Repeater</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-12.png" alt="jwt-attacks-3-12" data-proofer-ignore></p><li><p>Repace the JWT token with the one previously generated on <a href="http://jwt.io">jwt.io</a> and send the reset, you’ll get a code 200</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-13.png" alt="jwt-attacks-3-13" data-proofer-ignore></p><li><p>Again, get the link to the response and paste it in the browser</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-14-1.png" alt="jwt-attacks-3-14-1" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-14-2.png" alt="jwt-attacks-3-14-2" data-proofer-ignore></p><li><p>Finally, click on the “delete” link for “carlos”</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-15-1.png" alt="jwt-attacks-3-15-1" data-proofer-ignore></p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-15-2.png" alt="jwt-attacks-3-15-2" data-proofer-ignore></p><li><p>In the HTTP History, find the “/admin/delete?username=carlos” page and send it to the Repeater</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-16.png" alt="jwt-attacks-3-16" data-proofer-ignore></p><li><p>Replace the token with the modified previous one (the same previously generated on <a href="http://jwt.io">jwt.io</a>). Send the reset, you’ll get a code 302</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-17.png" alt="jwt-attacks-3-17" data-proofer-ignore></p><li><p>Go back to the browser, the lab is solved</p><p><img data-src="/assets/images/2022-06-18-jwt-attacks/3-18.png" alt="jwt-attacks-3-18" data-proofer-ignore></p></ol><p><br /></p><p><span style="color:red">———- <em>update july 1st, 2022</em> ———-</span></p><h1 id="lab-4-jwt-authentication-bypass-via-jwk-header-injection">Lab 4: JWT authentication bypass via jwk header injection</h1><ol><li><p>Go to “My account”</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-1.png" alt="4-1.png" data-proofer-ignore></p><li><p>Enter the credentials “wiener” and “peter”</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-2.png" alt="4-2.png" data-proofer-ignore></p><li><p>In the HTTP History, find the page “/account” and send it to Repeater</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-3.png" alt="4-3.png" data-proofer-ignore></p><li><p>Go to the tab JWT Editor Keys on the right side</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-4.png" alt="4-4.png" data-proofer-ignore></p><li><p>Click on “New RSA Key”</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-5.png" alt="4-5.png" data-proofer-ignore></p><li><p>Click on “Generate”, the content will appear below, click on “OK”</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-6.png" alt="4-6.png" data-proofer-ignore></p><li><p>The new RSA key appears in the list</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-7.png" alt="4-7.png" data-proofer-ignore></p><li><p>Go back to the Repeater, in the JWS section, replace “wiener” with “administrator”, click on “sign” at the bottom window. If you have many keys, select the last one created just before (if you just have one, it’s selected by default) and click on “OK”</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-8.png" alt="4-8.png" data-proofer-ignore></p><li><p>When it’s done, click on “Attack” and select “Embedded JWK</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-9.png" alt="4-9.png" data-proofer-ignore></p><li><p>Choose the last key created, if needed and click on “OK”</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-10.png" alt="4-10.png" data-proofer-ignore></p><li><p>In the Repeater, go back to the “Raw” tab, send the reset (the few last steps has modified the JWT token), you’ll see a response with a code 200</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-11.png" alt="4-11.png" data-proofer-ignore></p><li><p>Generate the link for this response</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-12.png" alt="4-12.png" data-proofer-ignore></p><li><p>Copy this link</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-13.png" alt="4-13.png" data-proofer-ignore></p><li><p>Paste it on the web browser, you’re now an administrator. Go to the admin panel</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-14-1.png" alt="4-14-1.png" data-proofer-ignore></p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-14-2.png" alt="4-14-2.png" data-proofer-ignore></p><li><p>In the HTTP History, find the page “/admin” and send it to the Repeater</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-15.png" alt="4-15.png" data-proofer-ignore></p><li><p>Replace the token with the same one used for the previous reset (For simplicity, you can just copy it directly from the previous reset and paste it on this new reset), and get a response with a code 200</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-16.png" alt="4-16.png" data-proofer-ignore></p><li><p>Generate the link to this response and copy it</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-17-1.png" alt="4-17-1.png" data-proofer-ignore></p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-17-2.png" alt="4-17-2.png" data-proofer-ignore></p><li><p>Paste it in the web browser, and click on the “delete” link for “carlos”</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-18-1.png" alt="4-18-1.png" data-proofer-ignore></p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-18-2.png" alt="4-18-2.png" data-proofer-ignore></p><li><p>In the HTTP History, find the page “/admin/delete?username=carlos” and repeat the same steps (send to Repeater, paste the same modified token used on steps 11 and 16), you’ll get a code 302</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-19-1.png" alt="4-19-1.png" data-proofer-ignore></p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-19-2.png" alt="4-19-2.png" data-proofer-ignore></p><li><p>Go back to the web browser, the lab is now solved</p><p><img data-src="/assets/images/2022-07-01-jwt-attacks/4-19-3.png" alt="4-19-3.png" data-proofer-ignore></p></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeup/'>writeup</a>, <a href='/categories/walkthrough/'>walkthrough</a>, <a href='/categories/security/'>security</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/walkthrough/" class="post-tag no-text-decoration" >walkthrough</a> <a href="/tags/portswigger/" class="post-tag no-text-decoration" >portswigger</a> <a href="/tags/burp/" class="post-tag no-text-decoration" >burp</a> <a href="/tags/jwt/" class="post-tag no-text-decoration" >jwt</a> <a href="/tags/json/" class="post-tag no-text-decoration" >json</a> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/"> CC BY SA 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Portswigger+writeup+-+JWT+Attacks+-+cryptrz&url=https%3A%2F%2Fcryptrz.github.io%2Fposts%2Fjwt-attacks%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Portswigger+writeup+-+JWT+Attacks+-+cryptrz&u=https%3A%2F%2Fcryptrz.github.io%2Fposts%2Fjwt-attacks%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fcryptrz.github.io%2Fposts%2Fjwt-attacks%2F&text=Portswigger+writeup+-+JWT+Attacks+-+cryptrz" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/docker-hacking/">Docker hacking</a><li><a href="/posts/jwt-attacks/">Portswigger writeup - JWT Attacks</a><li><a href="/posts/stay-logged-in/">Portswigger writeup - Brute-forcing a stay-logged-in cookie</a><li><a href="/posts/offline-password-cracking/">Portswigger writeup - Offline Password Cracking</a><li><a href="/posts/password-reset-broken-logic/">Portswigger writeup - Password reset Broken Logic</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/burp/">burp</a> <a class="post-tag" href="/tags/portswigger/">portswigger</a> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/login/">login</a> <a class="post-tag" href="/tags/password/">password</a> <a class="post-tag" href="/tags/token/">token</a> <a class="post-tag" href="/tags/bruteforce/">bruteforce</a> <a class="post-tag" href="/tags/containers/">containers</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/stay-logged-in/"><div class="card-body"> <em class="small" data-ts="1668808800" data-df="ll" > Nov 19, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Portswigger writeup - Brute-forcing a stay-logged-in cookie</h3><div class="text-muted small"><p> These days I daily work on Web Security Academy, the final goal is becoming a Burp Suite Certified Practitioner. The last lab I was working on is Brute-forcing a stay-logged-in cookie, which is not...</p></div></div></a></div><div class="card"> <a href="/posts/offline-password-cracking/"><div class="card-body"> <em class="small" data-ts="1669413600" data-df="ll" > Nov 26, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Portswigger writeup - Offline Password Cracking</h3><div class="text-muted small"><p> This lab is in the same series than the previous article. The goal here to steal Carlos’s “stay-logged-in” cookie to steal and delete his account. Lab: Offline password cracking Click “My...</p></div></div></a></div><div class="card"> <a href="/posts/password-reset-broken-logic/"><div class="card-body"> <em class="small" data-ts="1669586400" data-df="ll" > Nov 28, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Portswigger writeup - Password reset Broken Logic</h3><div class="text-muted small"><p> Lab: Password reset broken logic In this lab, we’ll bypass the “Forgot password” feature to get access on Carlos’s account. On the home page, click “My account Next page, ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/hello/" class="btn btn-outline-primary" prompt="Older"><p>hello world</p></a> <a href="/posts/stay-logged-in/" class="btn btn-outline-primary" prompt="Newer"><p>Portswigger writeup - Brute-forcing a stay-logged-in cookie</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/cryptrz">cryptrz</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY SA 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/burp/">burp</a> <a class="post-tag" href="/tags/portswigger/">portswigger</a> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/login/">login</a> <a class="post-tag" href="/tags/password/">password</a> <a class="post-tag" href="/tags/token/">token</a> <a class="post-tag" href="/tags/bruteforce/">bruteforce</a> <a class="post-tag" href="/tags/containers/">containers</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
